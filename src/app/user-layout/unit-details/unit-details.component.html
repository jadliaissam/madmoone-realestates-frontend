<app-madmoone-spinner
  [loading]="loading"
  [height]="'650px'"
></app-madmoone-spinner>
<section
  class="contentWithParts"
  [hidden]="!project || !projectUnit || loading"
>
  <div class="main">
    <main class="w-100">
      <div class="right-part__wrapper d-flex flex-column">
        <div
          class="d-flex align-items-center"
          [ngClass]="{
            'mb-4':
              projectUnit?.video ||
              (projectUnit?.photos && (projectUnit?.photos)!.length > 0)
          }"
        >
          <img
            [src]="apiLink + project?.icon || ''"
            default="/assets/img/building-image-error.png"
            class="imgPromoteur border-radius-50"
            alt=""
          />
          <div class="d-flex flex-column mx-3">
            <h4 class="font-poppins-700 font-16 color-grey">
              {{ (project?.name | uppercase) || "" }}
            </h4>
          </div>
        </div>
        <div
          class="pswp-gallery mb20"
          id="my-gallery"
          *ngIf="_albums.length > 0"
        >
          <div class="gallery-in-first">
            <div
              *ngFor="let image of _albums | slice : 0 : 7; let i = index"
              class="gallery__item--{{ i + 1 }}"
              (click)="open(i)"
              [ngClass]="{
                'gallery-in-first__more': i === 6 && _albums.length > 7,
                'border-radius-8': i === 0
              }"
            >
              <img
                [src]="image.thumb"
                default="/assets/img/building-image-error.png"
                class="gallery__img border-radius-8"
              />
              <span
                *ngIf="i === 6 && _albums.length > 7"
                class="color-white font-poppins-500 font-12 position-absolute both w-100 text-center text-capitalize icon icon__element-plus hide-icon-mobile"
                style="z-index: 1"
                ><span class="pe-1">{{ _albums.length - 4 }}</span
                ><span class="d-none d-sm-inline">autres photos</span></span
              >
            </div>
          </div>
        </div>
        <ul
          ngbNav
          #nav="ngbNav"
          class="nav-tabs border-0"
          [destroyOnHide]="false"
        >
          <li
            [ngbNavItem]="1"
            [style]="{
              flex: 1,
              display:
                projectUnit?.video ||
                (projectUnit?.photos && (projectUnit?.photos)!.length > 0)
                  ? 'block'
                  : 'none'
            }"
          >
            <a ngbNavLink>Accueil</a>
            <ng-template ngbNavContent>
              <div
                class="d-flex tabsContent__description mb-4 flex-column flex-md-row align-items-start"
              >
                <div class="d-flex flex-column tabsContent__description--left">
                  <h3
                    class="font-14 font-poppins-400 color-default my-2"
                    *ngIf="projectUnit?.name"
                  >
                    {{ projectUnit?.name }}
                  </h3>
                  <h4 class="font-12 font-poppins-400 color-grey mb-2">
                    Déscription
                  </h4>
                  <p
                    *ngIf="projectUnit?.description"
                    [innerHTML]="projectUnit?.description | safeHtml"
                    class="font-12 color-grey3"
                  ></p>
                  <!-- <ul class="d-flex property-project mb-3 flex-wrap">
                    <li
                      class="d-flex flex-column icon icon__bigproject flex-wrap"
                      *ngIf="project?.type"
                    >
                      <h5
                        class="font-poppins-400 color-default font-11 text-capitalize pt-2"
                      >
                        état du projet
                      </h5>
                      <span class="font-11 font-poppins-400 color-grey3">{{
                        project?.type
                      }}</span>
                    </li>
                    <li
                      class="d-flex flex-column icon icon__bigproject flex-wrap"
                      *ngIf="project?.category"
                    >
                      <h5
                        class="font-poppins-400 color-default font-11 text-capitalize pt-2"
                      >
                        Type du projet
                      </h5>
                      <span class="font-11 font-poppins-400 color-grey3">{{
                        project?.category
                      }}</span>
                    </li>
                    <li
                      class="d-flex flex-column icon icon__bigproject flex-wrap"
                      *ngIf="project?.offer"
                    >
                      <h5
                        class="font-poppins-400 color-default font-11 text-capitalize pt-2"
                      >
                        type d’annonce
                      </h5>
                      <span class="font-11 font-poppins-400 color-grey3">{{
                        project?.offer
                      }}</span>
                    </li>
                    <li
                      class="d-flex flex-column icon icon__bigproject flex-wrap"
                      *ngIf="project?.state"
                    >
                      <h5
                        class="font-poppins-400 color-default font-11 text-capitalize pt-2"
                      >
                        Statut du projet
                      </h5>
                      <span class="font-11 font-poppins-400 color-grey3">{{
                        project?.state
                      }}</span>
                    </li>
                  </ul> -->
                </div>
                <div class="tabsContent__description--right">
                  <div
                    class="d-flex flex-column border-radius-8 bg-grey py-3 px-2 mb-3"
                  >
                    <div>
                      <h3
                        class="font-14 font-poppins-400 color-default mb-3 ms-2"
                      >
                        Informations générales
                      </h3>
                      <ul>
                        <li
                          class="font-poppins-400 color-grey icon icon__address mb-3 font-12 ps-4 ms-0 ms-sm-2"
                          *ngIf="project?.address"
                        >
                          {{ project?.address }}
                        </li>
                        <li
                          class="font-poppins-400 color-grey icon icon__profile mb-3 font-12 ps-4 ms-0 ms-sm-2"
                          *ngIf="project?.promoterName"
                        >
                          {{ project?.promoterName }}
                        </li>
                        <li
                          class="font-poppins-400 color-grey icon icon__briefcase mb-3 font-12 ps-4 ms-0 ms-sm-2"
                          *ngIf="project?.companyName"
                        >
                          {{ project?.companyName }}
                        </li>
                        <li
                          class="font-poppins-400 color-grey icon icon__city mb-3 font-12 ps-4 ms-0 ms-sm-2"
                          *ngIf="project?.city"
                        >
                          {{ project?.city }}
                        </li>
                        <li
                          class="font-poppins-400 color-grey icon icon__phone mb-3 font-12 ps-4 ms-0 ms-sm-2"
                          *ngIf="project?.phone"
                        >
                          {{ project?.phone }}
                        </li>
                        <li
                          class="font-poppins-400 color-grey icon icon__mail mb-3 font-12 ps-4 ms-0 ms-sm-2"
                          *ngIf="project?.email"
                        >
                          {{ project?.email }}
                        </li>
                        <li
                          class="font-poppins-400 color-grey icon icon__siteweb mb-3 font-12 ps-4 ms-0 ms-sm-2"
                          *ngIf="project?.webSite"
                        >
                          <a
                            class="d-inline color-default size-12"
                            target="_blank"
                            href="{{ project?.webSite }}"
                            >{{ project?.webSite }}</a
                          >
                        </li>
                      </ul>
                      <div class="d-flex contact">
                        <a
                          class="icon icon__phone flex-grow-1 align-items-center justify-content-center border-radius-8 both-after bg-green me-2"
                          *ngIf="project?.phone"
                          href="tel:{{ project?.phone }}"
                        >
                        </a>
                        <a
                          class="icon icon__mail2 flex-grow-1 align-items-center justify-content-center bg-white border-radius-8 both-after me-2"
                          *ngIf="project?.email"
                          target="_blank"
                          href="mailto:{{ project?.email }}"
                        ></a>
                        <a
                          class="icon icon__whatsapp flex-grow-1 align-items-center justify-content-center bg-white border-radius-8 both-after"
                          *ngIf="project?.whatsapp"
                          target="_blank"
                          href="{{ project?.whatsapp }}"
                        ></a>
                      </div>
                    </div>
                  </div>
                  <!-- <div class="mt-3">
                    <div
                      class="project-map border-radius-8"
                      [ngClass]="{
                        'no-map': !project?.longitude || !project?.latitude
                      }"
                      id="map"
                    ></div>
                  </div> -->
                  <div
                    class="d-flex flex-column border-radius-8 bg-grey py-3 px-2 mt-3"
                  >
                    <h3
                      class="color-default font-14 font-poppins-400 mb-3 ms-2"
                    >
                      Détails Bien
                    </h3>
                    <ul>
                      <li
                        class="font-poppins-400 color-grey icon icon__surface mb-2 font-12 ps-4 ms-0 ms-sm-2"
                      >
                        <span>{{projectUnit?.type! | translate}}</span>
                        <span class="dote ps-2"
                          >{{ projectUnit?.area }} m2</span
                        >
                        <!-- <span class="dote ps-2">Neuf</span> -->
                      </li>

                      <li
                        class="font-poppins-400 color-grey icon icon__home mb-2 font-12 ps-4 ms-0 ms-sm-2"
                        *ngIf="
                          (projectUnit?.rooms &&
                            (projectUnit?.rooms)!.length > 0) ||
                          projectUnit?.restRooms
                        "
                      >
                        <span *ngIf="(projectUnit?.rooms)!.length > 0"
                          >{{ projectUnit?.rooms?.length }} chambres</span
                        >
                        <span
                          [ngClass]="{
                            'dote ps-2': (projectUnit?.rooms)!.length > 0
                          }"
                          *ngIf="projectUnit?.restRooms"
                          >{{ projectUnit?.restRooms }} SDB</span
                        >
                      </li>
                      <li
                        class="font-poppins-400 color-grey icon icon__balcon mb-2 font-12 ps-4 ms-0 ms-sm-2"
                        *ngIf="projectUnit?.balcony || projectUnit?.salons"
                      >
                        <span *ngIf="projectUnit?.balcony"
                          >{{ projectUnit?.balcony }} Balcon</span
                        >
                        <span
                          [ngClass]="{ 'dote ps-2': projectUnit?.balcony }"
                          *ngIf="projectUnit?.salons"
                          >{{ projectUnit?.salons }} salons</span
                        >
                      </li>
                      <!-- <li
                        class="font-poppins-400 color-grey icon icon__direction mb-2 font-12 ps-4 ms-0 ms-sm-2"
                      >
                        Orientation : Nord east
                      </li> -->
                      <li
                        class="font-poppins-400 color-grey icon icon__parking mb-2 font-12 ps-4 ms-0 ms-sm-2 mb-4"
                        *ngIf="projectUnit?.parking"
                      >
                        Parcking : {{ projectUnit?.parking }}
                      </li>
                      <li class="ps-2" *ngIf="projectUnit?.priceMin">
                        <div class="price__wrapper d-flex flex-column">
                          <span class="font-poppins-400 font-14 color-grey mb-2"
                            >À partir de</span
                          >
                          <div class="d-flex flex-column">
                            <h2 class="price__main">
                              {{ projectUnit?.priceMin | currency : "MAD" }}
                            </h2>
                            <!-- <h4 class="price__promotion">1,892,000 MAD</h4> -->
                          </div>
                        </div>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <ng-container *ngIf="projectUnit?.rooms && projectUnit?.rooms!.length > 0">
                <h3 class="color-default font-16 font-poppins-400 mb-3">
                  Piéces de Bien
                </h3>
                <ngb-accordion #a="ngbAccordion">
                  <ngb-panel
                    id="custom-panel-{{i}}"
                    class="mb-2"
                    *ngFor="let room of projectUnit?.rooms; let i = index"
                  >
                    <ng-template ngbPanelTitle let-opened="opened">
                      <div class="flex-grow-1">
                        <span
                          class="icon icon__chambre2 font-poppins-500 font-14"
                          >{{ room?.name }}</span
                        >
                        <span
                          *ngIf="room?.area"
                          class="icon icon__surface font-sfpro-500 font-12 ps-4 pe-5 me-4"
                          >{{ room?.area }} m2</span
                        >
                        <span
                          *ngIf="room?.direction"
                          class="icon icon__surface font-sfpro-500 font-12 ps-4 pe-5 me-4"
                          >Exposition {{ room?.direction }}</span
                        >
                      </div>
                    </ng-template>
                    <ng-template ngbPanelContent>
                      <div class="row ">
                        <div class="col-12 col-md-4">
                          <img
                            class="border-radius-8 h-100"
                            [src]="apiLink + room?.mainPhoto || ''"
                            style="object-fit: cover;"
                            default="/assets/img/products/detail2.png"
                            alt=""
                          />
                        </div>
                        <div class="col-12 col-md-8 d-flex flex-column">
                          <h3 class="font-sfpro-500 font-14 mb-3">
                            Equipements de la piecé :
                          </h3>
                          <span *ngIf="!room?.equipements || room?.equipements?.length == 0">-</span>
                          <div class="row g-3" *ngIf="room?.equipements && room?.equipements!.length > 0">
                            <div class="col-12 col-md-6" *ngFor="let equi of room?.equipements">
                              <div
                                class="d-flex flex-grow-1 w-100 bg-grey p-3 border-radius-8 flex-column h-100"
                                style="min-height: 150px;"
                              >
                                <div class="d-flex justify-content-between">
                                  <strong class="font-sfpro-500 font-14"
                                    >{{equi?.name}}</strong
                                  >
                                  <span
                                  *ngIf="equi?.area"
                                    class="icon icon__surface font-sfpro-500 font-12 ps-4"
                                    >{{equi?.area}} m2</span
                                  >
                                </div>
                                <small class="mt-3" style="line-height : 1rem">{{equi?.description}}</small>
                              </div>
                            </div>
                          </div>
                        </div>
                        <!-- <div class="d-flex justify-content-center my-3">
                          <a
                            href="#"
                            class="d-inline color-default font-12 font-poppins-400"
                            >Réduire</a
                          >
                        </div> -->
                      </div>
                    </ng-template>
                  </ngb-panel>
                </ngb-accordion>
              </ng-container>
              <app-share-network></app-share-network>
            </ng-template>
          </li>
          <li [ngbNavItem]="2" *ngIf="projectUnit?.video" [style]="{ flex: 1 }">
            <a ngbNavLink>Vidéo</a>
            <ng-template ngbNavContent>
              <div
                class="bg-white m-auto p-4 border-radius-8 tabsContent__component"
              >
                <div class="d-flex flex-column">
                  <div
                    class="d-flex justify-content-between align-items-center"
                    style="margin-bottom: 32px"
                  >
                    <h2
                      class="color-default font-poppins-400 font-16 text-capitalize"
                    >
                      Vidéo du projet
                    </h2>
                  </div>
                  <ul
                    class="d-flex flex-wrap gallery_display_detail"
                    [ngClass]="{ 'flex-column': true }"
                  >
                    <li>
                      <a role="button">
                        <video
                          width="100%"
                          controls=""
                          class="border-radius-8"
                          [src]="apiLink + projectUnit?.video"
                          #videoPlayer
                        ></video>
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </ng-template>
          </li>
          <li
            [ngbNavItem]="3"
            [style]="{ flex: 1 }"
            *ngIf="projectUnit?.photos && (projectUnit?.photos)!.length > 0"
          >
            <a ngbNavLink>Photos</a>
            <ng-template ngbNavContent>
              <div
                class="bg-white m-auto p-4 border-radius-8 tabsContent__component"
              >
                <div class="d-flex flex-column">
                  <div
                    class="d-flex justify-content-between align-items-center"
                    style="margin-bottom: 32px"
                  >
                    <h2
                      class="color-default font-poppins-400 font-16 text-capitalize"
                    >
                      Photos du projet
                    </h2>
                    <div class="d-flex justify-content-between switch-display">
                      <button
                        class="icon icon__row-horizontal medium"
                        [ngClass]="{ current: horizontalViewMode }"
                        (click)="horizontalViewMode = true"
                      ></button>
                      <button
                        class="icon icon__row-vertical"
                        (click)="horizontalViewMode = false"
                        [ngClass]="{ current: !horizontalViewMode }"
                      ></button>
                    </div>
                  </div>
                  <ul
                    class="d-flex flex-wrap gallery_display_detail"
                    [ngClass]="{ 'flex-column': !horizontalViewMode }"
                  >
                    <li *ngFor="let image of _albums; let i = index">
                      <a
                        (click)="open(i)"
                        role="button"
                        class="images-tab-image-container"
                        ><img
                          [src]="image.thumb"
                          default="/assets/img/building-image-error.png"
                          class="border-radius-8"
                          alt="test"
                      /></a>
                    </li>
                  </ul>
                </div>
              </div>
            </ng-template>
          </li>
        </ul>
        <div
          [ngbNavOutlet]="nav"
          [ngClass]="{
            'mt-2':
              projectUnit?.video ||
              (projectUnit?.photos && (projectUnit?.photos)!.length > 0)
          }"
          class="right-part__wrapper--tabsContent"
        ></div>
      </div>
    </main>
  </div>
</section>
<app-empty-state-v2
  *ngIf="!project && !loading"
  [mainClass]="'wrapperProjects'"
  [secondClass]="'wrapperProjects__new'"
  [title]="'Projets'"
  [description]="'Aucun projet trouvé'"
  [hasAction]="false"
></app-empty-state-v2>
